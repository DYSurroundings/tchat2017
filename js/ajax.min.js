function creerXHR(){var b=null;if(window.XMLHttpRequest||window.ActiveXObject){if(window.ActiveXObject){try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){b=new ActiveXObject("Microsoft.XMLHTTP")}}else{b=new XMLHttpRequest()}}else{alert("Votre navigateur ne supporte pas l'objet XMLHTTPRequest...");return null}return b}function sendMessage(e){var d=document.querySelector("input.textarea");var a=document.querySelector('input[name="user_id"]').value;var g=document.querySelector("div.name").innerHTML;var b=document.querySelector("ol");e="texte="+d.value+"&user_id="+a+"&username="+g;var f=creerXHR();var c="ajaxCall.php";f.open("POST",c,true);f.setRequestHeader("Content-type","application/x-www-form-urlencoded");f.onreadystatechange=function(){if(f.readyState==4&&f.status==200){if(f.responseText=="ok"){b.innerHTML="";d.value="";getLastsMessage()}}};f.send(e)}function getLastsMessage(){var a=document.querySelector("ol");var c=creerXHR();var b="ajaxCall.php?getLastsMessage";c.open("GET",b,true);c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){a.innerHTML="";var e=JSON.parse(c.responseText);for(var d=(Object.keys(e).length-1);d>=0;d--){pushLastMessage(e[d].texte,e[d].login,e[d].ladate)}}};c.send()}function pushLastMessage(b,c,a){chat=document.querySelector("ol");chat.innerHTML+="<li class='other'><div class='avatar'><img src='http://i.imgur.com/DY6gND0.png' draggable='false'/></div></div><div class='msg'><p id='colorenvoie'>"+c+"</p><p>"+b+"</p><time>"+a+"</time></div></li>";window.scrollTo(0,document.body.scrollHeight+100)}function VerifNbMsg(){var b=creerXHR();var a="ajaxCount.php";b.open("GET",a,true);b.onreadystatechange=function(){if(b.readyState==4&&b.status==200){if(b.responseText=="charge"){getLastsMessage()}}};b.send()};